<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Sum of sines and cosines &mdash; Tutorials on imaging, computing and mathematics</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/copybutton.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Tutorials on imaging, computing and mathematics" href="index.html" />
    <link rel="next" title="Some algebra with summation" href="some_sums.html" />
    <link rel="prev" title="The angle sum rule" href="angle_sum.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <p><span class="math">\(\newcommand{L}[1]{\| #1 \|}\newcommand{VL}[1]{\L{ \vec{#1} }}\newcommand{R}[1]{\operatorname{Re}\,(#1)}\newcommand{I}[1]{\operatorname{Im}\, (#1)}\)</span></p>
<div class="section" id="sum-of-sines-and-cosines">
<h1>Sum of sines and cosines<a class="headerlink" href="#sum-of-sines-and-cosines" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li>Samuel Greitzer &#8220;Many cheerful Facts&#8221; Arbelos 4 (1986), no. 5, 14-17.</li>
<li>Michael P. Knapp <a class="reference external" href="http://evergreen.loyola.edu/mpknapp/www/papers/knapp-sv.pdf">Sines and cosines of angles in arithmetic progression</a> Mathematics
Magazine 82.5 (2009): 371-372.</li>
</ul>
<p>The proof on this page follows Samuel Greitzner&#8217;s &#8220;Many cheerful facts&#8221;.</p>
<div class="section" id="theorems">
<h2>Theorems<a class="headerlink" href="#theorems" title="Permalink to this headline">¶</a></h2>
<p>For a positive integer <span class="math">\(N\)</span> and real numbers <span class="math">\(a, d\)</span>:</p>
<div class="math">
\[R \triangleq \frac{\sin(N \frac{1}{2}d)}{\sin(\frac{1}{2} d)} \\
\sum_{n=0}^{N-1} \cos(a + nd) =
\begin{cases}
N \cos a & \text{if } \sin(\frac{1}{2}d) = 0 \\
R \cos ( a + (N - 1) \frac{1}{2} d) & \text{otherwise}
\end{cases}
\\
\sum_{n=0}^{N-1} \sin(a + nd) =
\begin{cases}
N \sin a & \text{if } \sin(\frac{1}{2}d) = 0 \\
R \sin ( a + (N - 1) \frac{1}{2} d) & \text{otherwise}
\end{cases}\]</div></div>
<div class="section" id="proof">
<h2>Proof<a class="headerlink" href="#proof" title="Permalink to this headline">¶</a></h2>
<p>The basic order of play is to rearrange the sum so that the terms in the
current iteration of the sum cancel terms in the previous iteration, and
we can therefore get rid of the sum. This is a <a class="reference external" href="https://en.wikipedia.org/wiki/Telescoping_series">telescoping
series</a>.</p>
<p>We will do the cosine series first. The sine proof is almost identical.</p>
<div class="section" id="cosine-sum">
<h3>Cosine sum<a class="headerlink" href="#cosine-sum" title="Permalink to this headline">¶</a></h3>
<p>For reasons that will become clear later, we start with the case where
<span class="math">\(\sin(\frac{1}{2} d) = 0\)</span>.</p>
<p>If <span class="math">\(\sin(\frac{1}{2} d) = 0\)</span> then <span class="math">\(d\)</span> is a multiple of
<span class="math">\(2 \pi\)</span> and:</p>
<div class="math">
\[\cos(a) = \cos(a + d) = \cos(a + 2 d) ...\]</div>
<p>and:</p>
<div class="math">
\[\sum_{n=0}^{N-1} \cos(a + nd) = N \cos a\]</div>
<p>Now we cover the case where <span class="math">\(\sin(\frac{1}{2} d) \ne 0\)</span>.</p>
<p>From the <a class="reference external" href="./angle_sum.html">angle sum rules</a>:</p>
<div class="math">
\[\sin(\alpha + \beta) = \sin \alpha \cos \beta + \cos \alpha \sin \beta \\
\sin(\alpha - \beta) = \sin \alpha \cos \beta - \cos \alpha \sin \beta \\
\implies \\
\sin(\alpha + \beta) - \sin(\alpha - \beta) = 2\cos \alpha \sin \beta\]</div><p>Let:</p>
<div class="math">
\[C \triangleq \sum_{n=0}^{N-1}\cos(a + nd)\]</div>
<p>Only if <span class="math">\(\sin(\frac{1}{2} d) \ne 0\)</span>, we can safely multiply both
sides by <span class="math">\(2 \sin(\frac{1}{2} d)\)</span>:</p>
<div class="math">
\[2 \sin(\frac{1}{2} d) C = \sum_{n=0}^{N-1}2 \cos(a + nd) \sin(\frac{1}{2}d)\]</div>
<p>Now we use the angle sum derivation above. Let <span class="math">\(\alpha = a + nd\)</span>,
<span class="math">\(\beta = \frac{1}{2} d\)</span>:</p>
<div class="math">
\[2 \sin(\frac{1}{2} d) C =
\sum_{n=0}^{N-1} \bigg ( \sin(a + (n + \frac{1}{2}) d) - \sin(a + (n -
\frac{1}{2}) d) \bigg )\]</div><p>Writing out the terms in the sum:</p>
<div class="math">
\[2 \sin(\frac{1}{2} d) C = \\
\bigg ( \sin(a + \frac{1}{2}d) - \sin(a - \frac{1}{2}d) \bigg ) + \\
\bigg ( \sin(a + \frac{3}{2}d) - \sin(a + \frac{1}{2}d) \bigg ) + \\
... \\
\bigg ( \sin(a + (N - \frac{3}{2}) d) - \sin(a + (N - \frac{5}{2} d) \bigg ) +
\\
\bigg ( \sin(a + (N - \frac{1}{2}) d) - \sin(a + (N - \frac{3}{2} d) \bigg )\]</div><p>The series telescopes, because the second term at each iteration cancels
the first term at the previous iteration. We are left only with the
first term in the last iteration and the second term from the first:</p>
<div class="math">
\[2 \sin(\frac{1}{2} d) C =
\sin(a + (N - \frac{1}{2}) d) - \sin(a - \frac{1}{2} d)\]</div>
<p>Now we go the opposite direction with
<span class="math">\(\sin(\alpha + \beta) - \sin(\alpha - \beta) = 2\cos \alpha \sin \beta\)</span>.</p>
<p>Let <span class="math">\(\alpha + \beta = a + (N - \frac{1}{2}) d\)</span> and
<span class="math">\(\alpha - \beta = a - \frac{1}{2} d\)</span>. Solving for <span class="math">\(\alpha\)</span>
and <span class="math">\(\beta\)</span> we get:</p>
<div class="math">
\[2 \sin(\frac{1}{2} d) C =
2 \cos( a + (N - 1) \frac{1}{2} d ) \sin( N \frac{1}{2} d )\]</div>
<p>We solve for <span class="math">\(C\)</span> to finish the proof.</p>
<p><span class="math">\(\blacksquare\)</span></p>
</div>
<div class="section" id="sine-sum">
<h3>Sine sum<a class="headerlink" href="#sine-sum" title="Permalink to this headline">¶</a></h3>
<p>This is almost identical, but applying:</p>
<div class="math">
\[\cos(\alpha + \beta) = \cos \alpha \cos \beta - \sin \alpha \sin \beta \\
\cos(\alpha - \beta) = \cos \alpha \cos \beta + \sin \alpha \sin \beta \\
\implies \\
\cos(\alpha + \beta) - \cos(\alpha - \beta) = -2 \sin \alpha \sin \beta\]</div><p>Let:</p>
<div class="math">
\[S \triangleq \sum_{n=0}^{N-1}\sin(a + nd)\]</div>
<p>Only if <span class="math">\(\sin(\frac{1}{2}d) \ne 0\)</span>, we can safely multiply both
sides by <span class="math">\(-2 \sin(\frac{1}{2}d)\)</span> and continue with the same steps
as for the cosine:</p>
<div class="math">
\[-2 \sin(\frac{1}{2} d) S =
\sum_{n=0}^{N-1}-2 \sin( a + nd ) \sin( \frac{1}{2} d ) \\
= \sum_{n=0}^{N-1} \bigg ( \cos ( a + ( n + \frac{1}{2}) d )
- \cos ( a + (n - \frac{1}{2}) d ) \bigg ) \\
= \cos ( a + (N - \frac{1}{2}) d ) - \cos ( a - \frac{1}{2} d ) \\
= -2 \sin (a + (N - 1)\frac{1}{2} d ) \sin ( N \frac{1}{2} d )\]</div><p>Then solve for <span class="math">\(S\)</span>.</p>
<p><span class="math">\(\blacksquare\)</span></p>
</div>
</div>
<div class="section" id="numerical-check">
<h2>Numerical check<a class="headerlink" href="#numerical-check" title="Permalink to this headline">¶</a></h2>
<p>We check that the formulae give the right answers from numerical sums.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">division</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">predicted_cos_sum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">d2</span> <span class="o">=</span> <span class="n">d</span> <span class="o">/</span> <span class="mf">2.</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">d2</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">N</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="n">d2</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">d2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">d2</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">predicted_sin_sum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">d2</span> <span class="o">=</span> <span class="n">d</span> <span class="o">/</span> <span class="mf">2.</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">d2</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">N</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="n">d2</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">d2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">d2</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">actual_cos_sum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">d</span> <span class="o">+</span> <span class="n">a</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angles</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">actual_sin_sum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">d</span> <span class="o">+</span> <span class="n">a</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angles</span><span class="p">))</span>
</pre></div>
</div>
<p>When <span class="math">\(\sin(\frac{1}{2}d) \ne 0\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;cos&#39;</span><span class="p">,</span>
<span class="gp">... </span>      <span class="n">predicted_cos_sum</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span>
<span class="gp">... </span>      <span class="n">actual_cos_sum</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">17</span><span class="p">))</span>
<span class="go">cos 7.7038472261 7.7038472261</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;sin&#39;</span><span class="p">,</span>
<span class="gp">... </span>      <span class="n">predicted_sin_sum</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span>
<span class="gp">... </span>      <span class="n">actual_sin_sum</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">17</span><span class="p">))</span>
<span class="go">sin -6.27049470825 -6.27049470825</span>
</pre></div>
</div>
<p>When <span class="math">\(\sin(\frac{1}{2}d) \approx 0\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;cos : sin(d/2) ~ 0;&#39;</span><span class="p">,</span>
<span class="gp">... </span>      <span class="n">predicted_cos_sum</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span>
<span class="gp">... </span>      <span class="n">actual_cos_sum</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">17</span><span class="p">))</span>
<span class="go">cos : sin(d/2) ~ 0; -11.1119415547 -11.1119415547</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&#39;sin : sin(d/2) ~ 0;&#39;</span><span class="p">,</span>
<span class="gp">... </span>      <span class="n">predicted_sin_sum</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span>
<span class="gp">... </span>      <span class="n">actual_sin_sum</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">17</span><span class="p">))</span>
<span class="go">sin : sin(d/2) ~ 0; -12.8656424202 -12.8656424202</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Sum of sines and cosines</a><ul>
<li><a class="reference internal" href="#theorems">Theorems</a></li>
<li><a class="reference internal" href="#proof">Proof</a><ul>
<li><a class="reference internal" href="#cosine-sum">Cosine sum</a></li>
<li><a class="reference internal" href="#sine-sum">Sine sum</a></li>
</ul>
</li>
<li><a class="reference internal" href="#numerical-check">Numerical check</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="angle_sum.html" title="previous chapter">The angle sum rule</a></li>
      <li>Next: <a href="some_sums.html" title="next chapter">Some algebra with summation</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/sums_of_cosines.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Matthew Brett.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.6</a>
      
      |
      <a href="_sources/sums_of_cosines.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>