<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Correlated regressors &mdash; Tutorials on imaging, computing and mathematics</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/copybutton.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Tutorials on imaging, computing and mathematics" href="index.html" />
    <link rel="next" title="Notes on the Bonferroni threshold" href="bonferroni_correction.html" />
    <link rel="prev" title="Smoothing as convolution" href="smoothing_as_convolution.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <p><span class="math">\(\newcommand{L}[1]{\| #1 \|}\newcommand{VL}[1]{\L{ \vec{#1} }}\newcommand{R}[1]{\operatorname{Re}\,(#1)}\newcommand{I}[1]{\operatorname{Im}\, (#1)}\)</span></p>
<div class="section" id="correlated-regressors">
<h1>Correlated regressors<a class="headerlink" href="#correlated-regressors" title="Permalink to this headline">Â¶</a></h1>
<p>Written with J-B Poline.</p>
<p>Load and configure libraries:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy.linalg</span> <span class="kn">as</span> <span class="nn">npl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Make numpy print 4 significant digits for prettiness</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Seed random number generator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
<p>Imagine we have a TR (image) every 2 seconds, for 30 seconds. Here are
the times of the TR onsets, in seconds:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">times</span>
<span class="go">array([ 0,  2,  4,  6,  8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28])</span>
</pre></div>
</div>
<p>Now we make a function returning an HRF shape for an input vector of
times:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Gamma distribution from scipy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">gamma</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">spm_hrf</span><span class="p">(</span><span class="n">times</span><span class="p">):</span>
<span class="gp">... </span>    <span class="sd">&quot;&quot;&quot; Return values for SPM-like HRF at given times &quot;&quot;&quot;</span>
<span class="gp">... </span>    <span class="c1"># Make output vector</span>
<span class="gp">... </span>    <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">))</span>
<span class="gp">... </span>    <span class="c1"># Only evaluate gamma above 0 (undefined at &lt;= 0)</span>
<span class="gp">... </span>    <span class="n">valid_times</span> <span class="o">=</span> <span class="n">times</span><span class="p">[</span><span class="n">times</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span>    <span class="c1"># Gamma pdf for the peak</span>
<span class="gp">... </span>    <span class="n">peak_values</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">valid_times</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Gamma pdf for the undershoot</span>
<span class="gp">... </span>    <span class="n">undershoot_values</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">valid_times</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Combine them, put back into values vector</span>
<span class="gp">... </span>    <span class="n">values</span><span class="p">[</span><span class="n">times</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">peak_values</span> <span class="o">-</span> <span class="mf">0.35</span> <span class="o">*</span> <span class="n">undershoot_values</span>
<span class="gp">... </span>    <span class="c1"># Scale area under curve to 1</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">values</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
<p>Sample the HRF at the given times (to simulate an event starting at time
0), and at times - 2 (simulating an event starting at time 2):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hrf1</span> <span class="o">=</span> <span class="n">spm_hrf</span><span class="p">(</span><span class="n">times</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hrf2</span> <span class="o">=</span> <span class="n">spm_hrf</span><span class="p">(</span><span class="n">times</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># An HRF with 2 seconds (one TR) delay</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hrf1</span> <span class="o">=</span> <span class="p">(</span><span class="n">hrf1</span> <span class="o">-</span> <span class="n">hrf1</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="c1"># Rescale and mean center</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hrf2</span> <span class="o">=</span> <span class="p">(</span><span class="n">hrf2</span> <span class="o">-</span> <span class="n">hrf2</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">hrf1</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">hrf2</span><span class="p">)</span>
<span class="go">[...]</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//correlated_regressors-4.png">png</a>, <a class="reference external" href=".//correlated_regressors-4.hires.png">hires.png</a>, <a class="reference external" href=".//correlated_regressors-4.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/correlated_regressors-4.png" src="_images/correlated_regressors-4.png" />
</div>
<p>The Pearson correlation coefficient between the HRFs for the two events:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">hrf1</span><span class="p">,</span> <span class="n">hrf2</span><span class="p">)</span>
<span class="go">array([[ 1.    ,  0.7023],</span>
<span class="go">       [ 0.7023,  1.    ]])</span>
</pre></div>
</div>
<p>Make a signal that comes from the combination of the two HRFs:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span> <span class="o">=</span> <span class="n">hrf1</span> <span class="o">+</span> <span class="n">hrf2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hrf1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;hrf1&#39;</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hrf2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;hrf2&#39;</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;signal (combined hrfs)&#39;</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="go">&lt;...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//correlated_regressors-6.png">png</a>, <a class="reference external" href=".//correlated_regressors-6.hires.png">hires.png</a>, <a class="reference external" href=".//correlated_regressors-6.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/correlated_regressors-6.png" src="_images/correlated_regressors-6.png" />
</div>
<p>We&#8217;re going to make our simulated data from taking the signal (the two HRFs)
and adding some random noise:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">times</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">+</span> <span class="n">noise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">signal</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">)</span>
<span class="go">[...]</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//correlated_regressors-7.png">png</a>, <a class="reference external" href=".//correlated_regressors-7.hires.png">hires.png</a>, <a class="reference external" href=".//correlated_regressors-7.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/correlated_regressors-7.png" src="_images/correlated_regressors-7.png" />
</div>
<p>We are going to model this simulated signal in several different ways.  First,
we make a model that only has the first HRF as a regressor (plus a column of
ones to model the mean of the data):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X_one</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">hrf1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">hrf1</span><span class="p">)))</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_one</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="go">&lt;...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Model with first HRF regressor only&#39;</span><span class="p">)</span>
<span class="go">&lt;...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//correlated_regressors-8.png">png</a>, <a class="reference external" href=".//correlated_regressors-8.hires.png">hires.png</a>, <a class="reference external" href=".//correlated_regressors-8.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/correlated_regressors-8.png" src="_images/correlated_regressors-8.png" />
</div>
<p>Next we make a model where we also include the second HRF as a regressor:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X_both</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">hrf1</span><span class="p">,</span> <span class="n">hrf2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">hrf1</span><span class="p">)))</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_both</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="go">&lt;...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Model with both HRF regressors&#39;</span><span class="p">)</span>
<span class="go">&lt;...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//correlated_regressors-9.png">png</a>, <a class="reference external" href=".//correlated_regressors-9.hires.png">hires.png</a>, <a class="reference external" href=".//correlated_regressors-9.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/correlated_regressors-9.png" src="_images/correlated_regressors-9.png" />
</div>
<p>Now we make a very large number of data vectors, each with the signal
(both HRFs) plus a different vector of noise.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iters</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Make 10000 Y vectors (new noise for each colum)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noise_vectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">iters</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># add signal to make data vectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ys</span> <span class="o">=</span> <span class="n">noise_vectors</span> <span class="o">+</span> <span class="n">signal</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ys</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(15, 10000)</span>
</pre></div>
</div>
<p>We first fit the model with only the first HRF regressor to every (signal +
noise) sample vector.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit X_one to signals + noise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B_ones</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">X_one</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Ys</span><span class="p">)</span>
</pre></div>
</div>
<p>Next fit the model with both HRFs as regressors:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fit X_both to signals + noise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B_boths</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">X_both</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Ys</span><span class="p">)</span>
</pre></div>
</div>
<p>Remember that the students-t statistic is:</p>
<div class="math">
\[t = \frac{c^T \hat\beta}{\sqrt{\mathrm{var}(c^T \hat\beta)}}\]</div>
<p>which works out to:</p>
<div class="math">
\[t = \frac{c^T \hat\beta}{\sqrt{\hat{\sigma}^2 c^T (X^T X)^+ c}}\]</div>
<p>where <span class="math">\(\hat{\sigma}^2\)</span> is our estimate of variance in the residuals, and
<span class="math">\((X^T X)^+\)</span> is the <a class="reference external" href="https://en.wikipedia.org/wiki/Moore%E2%80%93Penrose_pseudoinverse">pseudo-inverse</a> of
<span class="math">\(X^T X\)</span>.</p>
<p>That&#8217;s the theory. So, what is the distribution of the estimates we get for
the first beta, in the single-HRF model?</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">B_ones</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="go">(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">B_ones</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">1.47669405469</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//correlated_regressors-13.png">png</a>, <a class="reference external" href=".//correlated_regressors-13.hires.png">hires.png</a>, <a class="reference external" href=".//correlated_regressors-13.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/correlated_regressors-13.png" src="_images/correlated_regressors-13.png" />
</div>
<p>The standard deviation of the estimates is what we observe. Does this
match what we would predict from the t-statistic formula above?</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">C_one</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])[:,</span> <span class="bp">None</span><span class="p">]</span>  <span class="c1"># column vector</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">C_one</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">npl</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">X_one</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X_one</span><span class="p">))</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">C_one</span><span class="p">)))</span>
<span class="go">array([[ 1.485]])</span>
</pre></div>
</div>
<p>Notice that the mean of the estimates, is somewhere above one, even
though we only added 1 times the first HRF as the signal:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">B_ones</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">1.68134012906</span>
</pre></div>
</div>
<p>This is because the single first regresssor has to fit <em>both</em> the first HRF in
the signal, and as much as possible of the second HRF in the signal, because
there is nothing else in the model to fit the second HRF shape.</p>
<p>What estimates do we get for the first regressor, when we have both regressors
in the model?</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">B_boths</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="go">(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">B_boths</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">B_boths</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">0.968933589198 2.08274190893</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//correlated_regressors-16.png">png</a>, <a class="reference external" href=".//correlated_regressors-16.hires.png">hires.png</a>, <a class="reference external" href=".//correlated_regressors-16.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/correlated_regressors-16.png" src="_images/correlated_regressors-16.png" />
</div>
<p>Two things have happened now we added the second (correlated) hrf2 regressor.
First, the mean of the parameter for the hrf1 regressor has dropped to 1,
because hrf1 is no longer having to model the signal from the second HRF.
Second, the variability of the estimate has increased.  This is what the
bottom half of the t-statistic predicts:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">C_both</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])[:,</span> <span class="bp">None</span><span class="p">]</span>  <span class="c1"># column vector</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">C_both</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">npl</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">X_both</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X_both</span><span class="p">))</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">C_both</span><span class="p">)))</span>
<span class="go">array([[ 2.0861]])</span>
</pre></div>
</div>
<p>The estimate of the parameter for hrf2 has a mean of around 1, like the
parameter estimates for hrf1. This is what we expect because we have 1 x hrf1
and 1 x hrf2 in the signal. Not surprisingly, the hrf2 parameter estimate has
a similar variability to that for the hrf1 parameter estimate:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">B_boths</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="go">(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">B_boths</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">B_boths</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">1.01451944676 2.08038932821</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//correlated_regressors-18.png">png</a>, <a class="reference external" href=".//correlated_regressors-18.hires.png">hires.png</a>, <a class="reference external" href=".//correlated_regressors-18.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/correlated_regressors-18.png" src="_images/correlated_regressors-18.png" />
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">C_both_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])[:,</span> <span class="bp">None</span><span class="p">]</span>  <span class="c1"># column vector</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">C_both_1</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">npl</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">X_both</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X_both</span><span class="p">))</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">C_both_1</span><span class="p">)))</span>
<span class="go">array([[ 2.0865]])</span>
</pre></div>
</div>
<p>The parameter estimates for hrf1 and hrf2 are anti-correlated:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Relationship of estimated parameter of hrf1 and hrf2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_boths</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">B_boths</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">B_boths</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">B_boths</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">array([[ 1.    , -0.7052],</span>
<span class="go">       [-0.7052,  1.    ]])</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//correlated_regressors-20.png">png</a>, <a class="reference external" href=".//correlated_regressors-20.hires.png">hires.png</a>, <a class="reference external" href=".//correlated_regressors-20.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/correlated_regressors-20.png" src="_images/correlated_regressors-20.png" />
</div>
<div class="section" id="orthogonalizing-hrf2-with-respect-to-hrf1">
<h2>Orthogonalizing hrf2 with respect to hrf1<a class="headerlink" href="#orthogonalizing-hrf2-with-respect-to-hrf1" title="Permalink to this headline">Â¶</a></h2>
<p>hrf2 is correlated with hrf1. That means that we can split up hrf2 into two
vectors, one being a multiple of hrf1, and the other being the remaining
unique contribution of hrf2. The sum of the two vectors is the original hrf2
regressor. Like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Regress hrf2 against hrf1 to get best fit of hrf2 using just hrf1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">hrf2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">hrf1</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>  <span class="c1"># hrf1 as column vector</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B_hrf1_in_hrf2</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>  <span class="c1"># scalar multiple of hrf1 to best fit hrf2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hrf1_in_hrf2</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B_hrf1_in_hrf2</span><span class="p">)</span>  <span class="c1"># portion of hrf2 that can be explained by hrf1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_hrf2</span> <span class="o">=</span> <span class="n">hrf2</span> <span class="o">-</span> <span class="n">hrf1_in_hrf2</span>  <span class="c1"># portion of hrf2 that cannot be explained by hrf1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">hrf1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;hrf1&#39;</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">hrf2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;hrf2&#39;</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">hrf1_in_hrf2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;hrf1 in hrf2&#39;</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">unique_hrf2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;hrf2 orth wrt hrf1&#39;</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="go">&lt;...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># hrf1 part of hrf2, plus unique part, equals original hrf2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">hrf2</span><span class="p">,</span> <span class="n">hrf1_in_hrf2</span> <span class="o">+</span> <span class="n">unique_hrf2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//correlated_regressors-21.png">png</a>, <a class="reference external" href=".//correlated_regressors-21.hires.png">hires.png</a>, <a class="reference external" href=".//correlated_regressors-21.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/correlated_regressors-21.png" src="_images/correlated_regressors-21.png" />
</div>
<p>How much of the first regressor did we find in the second regressor?</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">B_hrf1_in_hrf2</span>
<span class="go">array([ 0.7022])</span>
</pre></div>
</div>
<p>When we have the model with both hrf1 and hrf2, we are effectively multiplying
both parts of hrf2 by the same beta parameter, to fit the data. That is, we
are applying the same scaling to the part of hrf2 that is the same shape as
hrf1 and the part of hrf2 that cannot be formed from the hrf1 shape.</p>
<p>Now, what happens if we replace hrf2, by just the part of hrf2, that cannot be
explained by hrf1? Our second regressor is now hrf2 <em>orthogonalized with
respect to</em> hrf1:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X_both_o</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">hrf1</span><span class="p">,</span> <span class="n">unique_hrf2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">hrf1</span><span class="p">)))</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_both_o</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="go">&lt;...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//correlated_regressors-23.png">png</a>, <a class="reference external" href=".//correlated_regressors-23.hires.png">hires.png</a>, <a class="reference external" href=".//correlated_regressors-23.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/correlated_regressors-23.png" src="_images/correlated_regressors-23.png" />
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">X_both_o</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">times</span><span class="p">,</span> <span class="n">X_both_o</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">[...]</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//correlated_regressors-24.png">png</a>, <a class="reference external" href=".//correlated_regressors-24.hires.png">hires.png</a>, <a class="reference external" href=".//correlated_regressors-24.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/correlated_regressors-24.png" src="_images/correlated_regressors-24.png" />
</div>
<p>What will happen when we fit this model?</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">B_boths_o</span> <span class="o">=</span> <span class="n">npl</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">X_both_o</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Ys</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Distribution of parameter for hrf1 in orth model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">B_boths_o</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="go">(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">B_boths_o</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">B_boths_o</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">1.68134012906 1.47669405469</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//correlated_regressors-25.png">png</a>, <a class="reference external" href=".//correlated_regressors-25.hires.png">hires.png</a>, <a class="reference external" href=".//correlated_regressors-25.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/correlated_regressors-25.png" src="_images/correlated_regressors-25.png" />
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Predicted variance of hrf1 parameter is the same as for the</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># model with hrf1 on its own</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">C_both</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">npl</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">X_both_o</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X_both_o</span><span class="p">))</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">C_both</span><span class="p">)))</span>
<span class="go">array([[ 1.485]])</span>
</pre></div>
</div>
<p>The parameter for the hrf1 regressor has now returned to the same value and
variance as it had when hrf1 was the only regressor in the model (apart from
the mean). For the orthogonalized model, we removed the part of hrf2 that
could be explained by hrf1. Now, the amount of hrf1, that we could find in
hrf2, has been added back to the parameter for hrf1, in order to make the
fitted <span class="math">\(\hat{y}\)</span> values the same as for the model with both HRFs.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">B_boths</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span> <span class="o">+</span> <span class="n">B_hrf1_in_hrf2</span>
<span class="go">array([ 1.6711])</span>
</pre></div>
</div>
<p>The hrf1 parameter in the orthogonalized model is the same as for the model
that only includes hrf1 - as if the orthogonalized hrf2 was not present. The
parameter for orthogonalized hrf2 is the same as the parameter for hrf2 in the
not-orthogonalized model. We still need the same amount of the <em>orthogonal
part</em> of the second regressor to explain the signal:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example parameters from the single model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B_ones</span><span class="p">[:,:</span><span class="mi">5</span><span class="p">]</span>
<span class="go">array([[ 2.5395, -1.7854,  0.1398,  1.6884,  4.5348],</span>
<span class="go">       [-0.1606, -0.0069,  0.3315, -0.1837, -0.2644]])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example parameters from the non-orth model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B_boths</span><span class="p">[:,:</span><span class="mi">5</span><span class="p">]</span>
<span class="go">array([[ 2.0143, -2.4845, -2.5391, -0.9706,  4.9768],</span>
<span class="go">       [ 0.7481,  0.9955,  3.815 ,  3.7866, -0.6295],</span>
<span class="go">       [-0.1606, -0.0069,  0.3315, -0.1837, -0.2644]])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example parameters from the orth model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B_boths_o</span><span class="p">[:,:</span><span class="mi">5</span><span class="p">]</span>
<span class="go">array([[ 2.5395, -1.7854,  0.1398,  1.6884,  4.5348],</span>
<span class="go">       [ 0.7481,  0.9955,  3.815 ,  3.7866, -0.6295],</span>
<span class="go">       [-0.1606, -0.0069,  0.3315, -0.1837, -0.2644]])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># The parameter for the hrf1 regressor in the orth model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># is the same as the parameter for the hrf1 regressor in the</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># single regressor model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_ones</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">B_boths_o</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">B_ones</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">B_boths_o</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//correlated_regressors-31.png">png</a>, <a class="reference external" href=".//correlated_regressors-31.hires.png">hires.png</a>, <a class="reference external" href=".//correlated_regressors-31.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/correlated_regressors-31.png" src="_images/correlated_regressors-31.png" />
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># The parameter for the orthogonalized hrf2 regressor is the same as the</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># parameter for the non-orthogonalize hrf2 regressor in the</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># non-orthogonalized model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_boths</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">B_boths_o</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">B_boths</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">B_boths_o</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//correlated_regressors-32.png">png</a>, <a class="reference external" href=".//correlated_regressors-32.hires.png">hires.png</a>, <a class="reference external" href=".//correlated_regressors-32.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/correlated_regressors-32.png" src="_images/correlated_regressors-32.png" />
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># The parameter for the hrf1 regressor in the non-orth model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># is correlated with the parameter for the hrf1 regressor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># in the orth model.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_boths</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">B_boths_o</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">B_boths</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">B_boths_o</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">array([[ 1.    ,  0.7128],</span>
<span class="go">       [ 0.7128,  1.    ]])</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//correlated_regressors-33.png">png</a>, <a class="reference external" href=".//correlated_regressors-33.hires.png">hires.png</a>, <a class="reference external" href=".//correlated_regressors-33.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/correlated_regressors-33.png" src="_images/correlated_regressors-33.png" />
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Relationship of estimated parameters for hrf1 and orthogonalized hrf2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># (they should be independent)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B_boths_o</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">B_boths_o</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;+&#39;</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">B_boths_o</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">B_boths_o</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">array([[ 1.    , -0.0053],</span>
<span class="go">       [-0.0053,  1.    ]])</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//correlated_regressors-34.png">png</a>, <a class="reference external" href=".//correlated_regressors-34.hires.png">hires.png</a>, <a class="reference external" href=".//correlated_regressors-34.pdf">pdf</a>)</p>
<div class="figure">
<img alt="_images/correlated_regressors-34.png" src="_images/correlated_regressors-34.png" />
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Correlated regressors</a><ul>
<li><a class="reference internal" href="#orthogonalizing-hrf2-with-respect-to-hrf1">Orthogonalizing hrf2 with respect to hrf1</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="smoothing_as_convolution.html" title="previous chapter">Smoothing as convolution</a></li>
      <li>Next: <a href="bonferroni_correction.html" title="next chapter">Notes on the Bonferroni threshold</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/correlated_regressors.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Matthew Brett.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="_sources/correlated_regressors.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>